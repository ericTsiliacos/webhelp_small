
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head><meta xmlns="http://www.w3.org/1999/xhtml" name="description" content="This topic contains the step-by-step procedure for performing a rolling upgrade. Use the following steps to perform the rolling upgrade. If you have not done so already, backup your persistent disk ..."/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="copyright" content="(C) Copyright 2005"/><meta name="DC.rights.owner" content="(C) Copyright 2005"/><meta name="DC.Type" content="task"/><meta name="DC.Title" content="Rolling Upgrade Procedure"/><meta name="abstract" content="This topic contains the step-by-step procedure for performing a rolling upgrade."/><meta xmlns="http://www.w3.org/1999/xhtml" name="description" content="This topic contains the step-by-step procedure for performing a rolling upgrade."/><meta name="DC.Relation" scheme="URI" content="rolling_upgrade.html"/><meta name="DC.Format" content="XHTML"/><meta name="DC.Identifier" content="task_ybz_xf1_yk"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Rolling Upgrade Procedure</title><meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Type" content="text/html; charset=utf-8"><!----></meta><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/commonltr.css"><!----></link><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/pivotal.css"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript"><!--
          
          var prefix = "index.html";
          
          --></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" id="task_ybz_xf1_yk"><script xmlns="http://www.w3.org/1999/xhtml" src="//use.typekit.net/clb0qji.js" type="text/javascript"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  try {
				  Typekit.load();
			  } catch (e) {
			  }
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  document.domain = "pivotal.io";
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			WebFontConfig = {
			  google: { families: [ 'Source+Sans+Pro:300italic,400italic,300,400,600:latin' ] }
			};
			(function() {
			  var wf = document.createElement('script');
			  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
				'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
			  wf.type = 'text/javascript';
			  wf.async = 'true';
			  var s = document.getElementsByTagName('script')[0];
			  s.parentNode.insertBefore(wf, s);
			})();
		  </script>
<table class="nav"><tbody><tr><td colspan="2"><div id="permalink"><a href="#" title="Link to this page"/></div><div id="printlink"><a href="javascript:window.print();" title="Print this page"/></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="topics/upgrade-jar.html" title="Upgrade to GemFire XD 1.4 from GemFire XD 1.3.x.">Upgrading GemFire XD</a> / <a class="navheader_parent_path" href="rolling_upgrade.html" title="A rolling upgrade enables you to keep your existing distributed system running while you upgrade members.">Performing a Rolling Upgrade</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="rolling_upgrade.html" title="A rolling upgrade enables you to keep your existing distributed system running while you upgrade members."><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Performing a Rolling Upgrade</span></a></span>  </div></td></tr></tbody></table>

    <h1 class="title topictitle1">Rolling Upgrade Procedure</h1>

    
    <div class="body taskbody"><p class="shortdesc">This topic contains the step-by-step procedure for performing a rolling upgrade.</p>

        <div class="section context">
            <p class="p">Use the following steps to perform the rolling upgrade.</p>

        </div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">If you have not done so already, backup your persistent disk store files. See
                        <a class="xref" href="../reference/gfxd_commands/gfxd-backup.html#reference_13F8B5AFCD9049E380715D2EF0E33BDC" title="Creates a backup of operational disk stores for all members running in the distributed system. Each member with persistent data creates a backup of its own configuration and disk stores.">backup</a>.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd"><strong class="ph b">First upgrade one of the locators in the cluster.</strong> Open a terminal
                    console on the machine of the locator you are upgrading and stop the
                    locator:</span>
                <div class="itemgroup info">
                    <div class="p">For
                        example:<pre class="pre codeblock">$ gfxd locator stop -dir=<var class="keyword varname">locator_directory</var></pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the machine that hosts the locator that you want to upgrade, install the new
                    version of the software. You can use either the downloaded RPM file or ZIP file,
                    depending on which method you used to install the standalone GemFire XD 1.3.x
                    product. See <a class="xref" href="topics/install-rpm.html#concept_81306613B5524467B775DE623E41C139" title="If your operating system is Red Hat Enterprise Linux (RHEL), you can install GemFire XD from an RPM.">RHEL: Install GemFire XD from an RPM</a> or
                        <a class="xref" href="topics/installing-jar.html#concept_BAA7A69E48334B9EA7864CC550303421" title="This procedure describes how to install the GemFire XD software on a single computer or VM, for either a peer client or client/server deployments. Repeat the procedure to install GemFire XD on each physical or virtual machine where you want to run a GemFire XD member.">Windows/Linux: Install GemFire XD from a ZIP File</a>.</span>
                <div class="itemgroup info">
                    <div class="p">If you use the RPM installer, use the <samp class="ph codeph">rpm</samp> command to upgrade
                        the GemFire XD software. For example:
                        <pre class="pre codeblock">sudo rpm -Uvh pivotal-gemfirexd-1.4.0-48613.el6.noarch.rpm</pre>
</div>

                    <div class="p">If you use the GemFire XD ZIP file, unaip the file and make sure you update
                        your PATH environment variable to point to the new installation's
                            <span class="ph filepath">/bin</span> subdirectory. You can check the current
                        version by executing the
                        command:<pre class="pre codeblock">gfxd version
GemFireXD product directory: /opt/Pivotal_GemFireXD_140Beta_b49442_Linux
Java version:   1.4.0.Beta build 49442 10/30/2014 19:54:12 PDT javac 1.6.0_26
Native version: gemfirexd native code unavailable
Running on: ward-4.local/192.168.52.1, 8 cpu(s), x86_64 Mac OS X 10.10</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Restart your locator using the new GemFire XD software: </span>
                <div class="itemgroup info">
                    <div class="p">For
                        example:<pre class="pre codeblock">$ gfxd locator start -dir=<var class="keyword varname">locator_directory</var></pre>
</div>

                    <div class="note note"><span class="notetitle">Note:</span> After you begin the rolling upgrade process by starting a locator with the
                        version 1.4 software, you can no longer start GemFire XD members that use
                        the version 1.3.x software. GemFire XD members at version 1.3.x will fail to
                        connect to the distributed system with the
                        message:<pre class="pre codeblock">Rejecting the attempt of a member using an older version of the product to join an upgraded distributed system.  
Please restart the process using the new version of the product</pre>

                    </div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Confirm that the locator has started up and joined the cluster properly. </span>
                <div class="itemgroup info">
                    <div class="p">For example, ensure that the startup messages indicate the correct number of
                        members in the distributed
                        system:<pre class="pre codeblock">GemFireXD Locator pid: 5462 status: running
  Distributed system now has 3 members.
  Other members: ward(5436:datastore)&lt;v1&gt;:57629, ward(5445:datastore)&lt;v2&gt;:37660</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd"><strong class="ph b">Next upgrade all other locators.</strong> After you have confirmed the successful
                    upgrade of one locator, upgrade all other locators in the cluster using the same
                    procedure described in the previous steps. Confirm that each locator has joined
                    the cluster successfully.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd"><strong class="ph b">After all locators are upgraded, upgrade one data store at a time in the
                        cluster.</strong> If you are upgrading a data store that hosts partitioned
                    tables, check the redundancy state of the tables before stopping the server or
                    exporting its configuration and data. See <a class="xref" href="../data_management/configuring_ha_for_pr.html#configuring_pr_redundancy" title="Configure in-memory high availability for your partitioned table. Set other high-availability options, like redundancy zones and redundancy recovery strategies.">Configure High Availability for a Partitioned Table</a> for more information.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Stop the data store member that you want to upgrade.</span>
                <div class="itemgroup info">
                    <div class="p">For
                        example:<pre class="pre codeblock">$ gfxd server stop -dir=<var class="keyword varname">server_directory</var></pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the machine that hosts the data store that you want to upgrade, install the
                    new version of the software. You can use either the downloaded RPM file or ZIP
                    file, depending on which method you used to install the standalone GemFire XD
                    1.3.x product. See <a class="xref" href="topics/install-rpm.html#concept_81306613B5524467B775DE623E41C139" title="If your operating system is Red Hat Enterprise Linux (RHEL), you can install GemFire XD from an RPM.">RHEL: Install GemFire XD from an RPM</a> or
                        <a class="xref" href="topics/installing-jar.html#concept_BAA7A69E48334B9EA7864CC550303421" title="This procedure describes how to install the GemFire XD software on a single computer or VM, for either a peer client or client/server deployments. Repeat the procedure to install GemFire XD on each physical or virtual machine where you want to run a GemFire XD member.">Windows/Linux: Install GemFire XD from a ZIP File</a>.</span>
                <div class="itemgroup info">
                    <div class="p">If you use the RPM installer, use the <samp class="ph codeph">rpm</samp> command to upgrade
                        the GemFire XD software. For example:
                        <pre class="pre codeblock">sudo rpm -Uvh pivotal-gemfirexd-1.4.0-48613.el6.noarch.rpm</pre>
</div>

                    <div class="p">If you use the GemFire XD ZIP file, unaip the file and make sure you update
                        your PATH environment variable to point to the new installation's
                            <span class="ph filepath">/bin</span> subdirectory. You can check the current
                        version by executing the
                        command:<pre class="pre codeblock">gfxd version
GemFireXD product directory: /opt/Pivotal_GemFireXD_140Beta_b49442_Linux
Java version:   1.4.0.Beta build 49442 10/30/2014 19:54:12 PDT javac 1.6.0_26
Native version: gemfirexd native code unavailable
Running on: ward-4.local/192.168.52.1, 8 cpu(s), x86_64 Mac OS X 10.10</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Restart the server using the new GemFire XD software: </span>
                <div class="itemgroup info">
                    <div class="p">For
                        example:<pre class="pre codeblock">$ gfxd server start -dir=<var class="keyword varname">locator_directory</var></pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Confirm that the server has started up, joined the cluster properly and is communicating
                    with the other members.</span>
                <div class="itemgroup info">
                    <div class="p">For example, look in the server logs for a message similar to the
                        following:<pre class="pre codeblock">GemFireXD Server pid: 5445 status: running
  Distributed system now has 3 members.
  Other members: ward(5425:locator)&lt;v0&gt;:28439, ward(5436:datastore)&lt;v1&gt;:57629</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Check the server log for any severe error messages. You should debug these issues before
                    proceeding with the next server upgrade.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If you restarted a member with partitioned tables, verify that the member is
                    providing redundant buckets after the upgrade. See <a class="xref" href="../data_management/configuring_ha_for_pr.html#configuring_pr_redundancy" title="Configure in-memory high availability for your partitioned table. Set other high-availability options, like redundancy zones and redundancy recovery strategies.">Configure High Availability for a Partitioned Table</a> for instructions. Note that the number of buckets without redundancy will
                    change as the server recovers, so you need to wait until this statistic either
                    reaches zero or stops changing before proceeding with the upgrade. If you have
                        <samp class="ph codeph">startup-recovery-delay=-1</samp> configured for your partitioned
                    table, you will need to perform a rebalance after you start up each
                    member.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd"><strong class="ph b">Update all the other server members.</strong> After confirming successful upgrade
                    of a server member, repeat the process beginning with step 7 for the next
                    member.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd" id="task_ybz_xf1_yk__cmd_ptr_tqn_yk"><strong class="ph b">If desired, upgrade GemFire XD clients.</strong> You can only
                    do this after you have completed the upgrade on all locator and server members
                    in the cluster.</span>
            </li>
</ol>

    </div>

<div class="related-links"/>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="rolling_upgrade.html" title="A rolling upgrade enables you to keep your existing distributed system running while you upgrade members."><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Performing a Rolling Upgrade</span></a></span>  </div><div>
<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
      <a href="http://docs.pivotal.io" target="_blank">Pivotal Documentation</a>
      © 2014 <a href="http://www.pivotal.io/" target="_blank">Pivotal Software</a>, Inc. All Rights Reserved.
  </div>
  <div class="support">
    Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
   </div>
  </footer>
</div><!--end of container-->
</div>
</body>
</html>